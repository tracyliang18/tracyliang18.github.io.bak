<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"  />
<meta name="description" content="Tracyliang's Codes" />
<meta name="keywords" content="life,code,software,development,photography" />
<meta name="author" content="tracyliang" />
<link rel="stylesheet" type="text/css" href="/css/default.css" />
<link rel="stylesheet" type="text/css" href="/css/pretty_code.css" />
<link rel="alternate" type="application/atom+xml" href="http://tracyliang18.github.com/atom.xml" />

<title>You may say I am a dreamer, but I am not the only one. - tracyliang's tech blog</title>
</head>

<body>
<div id="wrap">
	<div id="header">
		<p id="toplinks">

		</p>

		<h1><a href="/"><div id="logo"></div>Dreamer<span class="fade">Museum</span></a></h1>
		<div class="slogan">
				<a href="/Coder.html" class="pink">Coder</a> :|: 
				<a href="/Cser.html" class="green">Cser</a> :|: 
                <a href="/Lifer.html" class="orange">Lifer</a>
		</div>

</div>

<div id="content">  
  <div id="post">
<h2>Polymorphism to the Rescue</h2>

<p class="publish_date">12 Jan 2011</p>

<p>The video processing service we used at <a href="www.spokt.com">spokt</a> got acquired by another company and the API changed. I created a code branch and started hacking away.  I have a model "VideoAttachment" which handles sending the encoding request and dealing with the asynchronous completion notification.
</p>

<p>
  It took some time to get all the ducks in a row and just as I was doing some final testing I realized that if I were to deploy my new code all the previously uploaded videos would no longer work. My head started filling with all the conditional logic I'd need to add... like to every method.  Skin crawling. I pulled the previous version of "VideoAttachment" out of the master branch to see what would need to happen... it wasn't going to be pretty. </p>
  <p>
    Luckily I had a crazy idea that turned out to be a very good one: use polymorphism to handle the conditional logic.  I saved the old video_attachment.rb file as legacy_video_attachment.rb, changed the class name then updated the 'type' attribute in the database to LegacyVideoAttachment. And done!
</p>

<p>Polymorphism, I think I love you! (You too STI, most of the time).</p>
</div>

<div id="related">
  <h3>Possibly Related Posts</h3>
  <ul class="posts">
    
      <li><span>15 Jun 2013</span> &raquo; <a href="/all/os/2013/06/15/Python-Attributes-and-Methods.html">python attributes and methods</a></li>
    
      <li><span>13 Jun 2013</span> &raquo; <a href="/all/rails/2013/06/13/prose-io.html">Prose Io</a></li>
    
      <li><span>30 May 2013</span> &raquo; <a href="/all/os/2013/05/30/the-nature-of-code.html">the nature of code learning</a></li>
    
  </ul>
</div>

<link rel="stylesheet" href="/css/styles/googlecode.css" type="text/css" media="screen, projection"/>
<script src="/javascript/highlight.pack.js" type="text/javascript""></script>
<script>hljs.initHighlightingOnLoad();</script>


<!-- This is for code colorization which doesn't seem to work very well in IE... i guess I don't care very much -->
<link rel="stylesheet" href="/css/styles/default.css">                        
<script src="/javascript/highlight.pack.js"></script>                                                  <script>hljs.initHighlightingOnLoad();</script> 
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shCore.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushRuby.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushPhp.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushXml.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushCss.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushBash.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushJScript.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushPython.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushC.js"></script>
<script language="javascript">
dp.SyntaxHighlighter.ClipboardSwf = 'http://communicatopia.s3.amazonaws.com/js/clipboard.swf';
//name, showGutter, showControls, collapseAll, firstLine , showColumns
dp.SyntaxHighlighter.HighlightAll('code',false, false,false,1,false);
</script>

</div>

<div id="footer">

    <a href="http://www.facebook.com/tracyliang">facebook</a> ||
    <a href="http://www.renren.com/347806128/">renren</a>

<p>&copy; 2013 <a href="/about.html">tracyliang</a>

</div>

</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4105222-2");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>

